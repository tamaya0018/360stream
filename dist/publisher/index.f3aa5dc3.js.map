{"mappings":"oeAAA,IAAAA,EAAAC,EAAA,S,aAGA,MAAMC,EAAqB,CAEzBC,aAAcC,eAAgBC,GAC5BC,KAAKC,YAAcP,EAAAQ,oBAAoBC,wBACrC,CAAEC,SAAUJ,KAAKK,WAAWC,QAE9BN,KAAKC,MAAMM,OAAOR,SACZA,EAAWS,MACnB,EAEAC,aAAc,WACZT,KAAKU,OAAOC,QAAQX,KAAKC,OACtBW,MAAM,KACLC,QAAQC,IAAI,sBAElB,GAIK,SAASC,EAAUC,EAAUX,GAClCY,EAAAC,OAAOC,KAAKnB,KAAMgB,GAClBhB,KAAKK,WAAaA,CACpB,CCzBO,SAASe,EAAkBC,EAAWC,GAE3CC,UAAUC,aAAaC,mBACpBb,MAAKc,IACoBA,EAAQC,QAAOC,GAAUA,EAAOC,OAASP,IAEjDQ,SAAQF,IACtB,MAAMG,EAASC,SAASC,cAAc,UACtCF,EAAOzB,MAAQsB,EAAOxB,SACtB2B,EAAOG,KAAON,EAAOO,MACrBd,EAAUe,YAAYL,EAAA,GACxB,IAEDM,OAAMC,IACLzB,QAAQC,IAAIwB,EAAIC,KAAO,KAAOD,EAAIE,QAAO,GAE/C,CDWAzB,EAAU0B,UAAYC,OAAOC,OAAO1B,EAAAC,OAAOuB,WAC3C1B,EAAU0B,UAAUG,YAAc7B,EAElC2B,OAAOG,OAAO9B,EAAU0B,UAAW7C,GE3BnC,MAAMkD,EAAgBd,SAASe,eAAe,SACxCC,EAAgBhB,SAASe,eAAe,eACxCE,EAAgBjB,SAASe,eAAe,eACxCG,EAAgBlB,SAASe,eAAe,cACxCI,EAAgBnB,SAASe,eAAe,eACxCK,EAAgBpB,SAASe,eAAe,kBAE7C,WAEC,MACMM,EAAK,IAAItC,EADM,IAAIuC,gBAAgBC,OAAOC,SAASC,QACnBC,IAAI,QAAST,SAC7CI,EAAGM,gBAETb,EAAKc,YAAcP,EAAG3C,OAAOmD,GAE7BV,EAAWW,QAAU,KACnB1C,EAAiB8B,EAAW,cAC5B9B,EAAiB6B,EAAY,eAG/BG,EAAcU,QAAUhE,gBAChBuD,EAAG5C,cAAY,EAGvBwC,EAAWc,SAAWjE,gBACduD,EAAGxD,aAAamD,EAAA,CAE1B,EApBC","sources":["publisher/js/publisher.js","publisher/js/mediaController.js","publisher/js/index.js"],"sourcesContent":["import { SkyWayStreamFactory } from '@skyway-sdk/room';\r\nimport { Member } from '../../js/member';\r\n\r\nconst publisherPrototype = {\r\n\r\n  previewVideo: async function (localVideo) {\r\n    this.video = await SkyWayStreamFactory.createCameraVideoStream(\r\n      { deviceId: this.cameraList.value }\r\n    );\r\n    this.video.attach(localVideo);\r\n    await localVideo.play();\r\n  },\r\n  \r\n  publishVideo: function () {\r\n    this.myInfo.publish(this.video)\r\n      .then( () => {\r\n        console.log(\"publish success!\");\r\n      })\r\n  }\r\n  \r\n};\r\n\r\nexport function Publisher(roomName, cameraList) {\r\n  Member.call(this, roomName);\r\n  this.cameraList = cameraList;\r\n}\r\n\r\nPublisher.prototype = Object.create(Member.prototype);\r\nPublisher.prototype.constructor = Publisher;\r\n\r\nObject.assign(Publisher.prototype, publisherPrototype);","export function listMediaDevices (mediaList, mediaType) {\r\n\r\n  navigator.mediaDevices.enumerateDevices()\r\n    .then(devices => {\r\n      const narrowedDevices = devices.filter(device => device.kind === mediaType);\r\n\r\n      narrowedDevices.forEach(device => {\r\n        const option = document.createElement(\"option\");\r\n        option.value = device.deviceId;\r\n        option.text = device.label;\r\n        mediaList.appendChild(option);\r\n      });\r\n    })\r\n    .catch(err => {\r\n      console.log(err.name + \": \" + err.message);\r\n    })\r\n}","import { Publisher } from './publisher';\r\nimport { listMediaDevices } from './mediaController';\r\n\r\nconst myId          = document.getElementById('my-id');\r\nconst localVideo    = document.getElementById('local-video');\r\nconst cameraList    = document.getElementById('camera-list');\r\nconst audioList     = document.getElementById('audio-list');\r\nconst listButton    = document.getElementById('list-button');\r\nconst publishButton = document.getElementById('publish-button');\r\n\r\n(async () => {\r\n\r\n  const searchParams = new URLSearchParams(window.location.search);\r\n  const me = new Publisher(searchParams.get('room'), cameraList);\r\n  await me.initMyContext();\r\n\r\n  myId.textContent = me.myInfo.id;\r\n\r\n  listButton.onclick = () => {\r\n    listMediaDevices(audioList, 'audioinput');\r\n    listMediaDevices(cameraList, 'videoinput');\r\n  };\r\n  \r\n  publishButton.onclick = async () => {\r\n    await me.publishVideo();\r\n  };\r\n\r\n  cameraList.onchange = async () => {\r\n    await me.previewVideo(localVideo);\r\n  };\r\n})();"],"names":["$hlpVk","parcelRequire","$fd60258e9fc95c27$var$publisherPrototype","previewVideo","async","localVideo","this","video","SkyWayStreamFactory","createCameraVideoStream","deviceId","cameraList","value","attach","play","publishVideo","myInfo","publish","then","console","log","$fd60258e9fc95c27$export$9abcd9565debde5d","roomName","$1C0k0","Member","call","$7945bee67ae858cd$export$f3ab9ff51c21cabc","mediaList","mediaType","navigator","mediaDevices","enumerateDevices","devices","filter","device","kind","forEach","option","document","createElement","text","label","appendChild","catch","err","name","message","prototype","Object","create","constructor","assign","$9582ffb6f4c1acc5$var$myId","getElementById","$9582ffb6f4c1acc5$var$localVideo","$9582ffb6f4c1acc5$var$cameraList","$9582ffb6f4c1acc5$var$audioList","$9582ffb6f4c1acc5$var$listButton","$9582ffb6f4c1acc5$var$publishButton","me","URLSearchParams","window","location","search","get","initMyContext","textContent","id","onclick","onchange"],"version":3,"file":"index.f3aa5dc3.js.map"}