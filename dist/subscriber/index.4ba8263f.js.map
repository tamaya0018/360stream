{"mappings":"oeAAAA,EAAA,S,iBAGA,MAAMC,EAAsB,CAE1BC,mBAAoB,SAAUC,GAG5B,GAFAC,QAAQC,IAAIF,EAAYG,UAAUC,IAClCH,QAAQC,IAAIG,KAAKC,QACbN,EAAYG,UAAUC,KAAOC,KAAKC,OAAOF,GAAI,OAEjD,MAAMG,EAAkBC,SAASC,cAAc,UAC/CF,EAAgBG,YAAc,GAAGV,EAAYG,UAAUC,OAAOJ,EAAYW,cAE1EN,KAAKO,WAAWC,YAAYN,GAE5BA,EAAgBO,QAAUC,UACxB,MAAMC,OAAEA,SAAiBX,KAAKC,OAAOW,UAAUjB,EAAYI,IAE3D,IAAIc,EACJ,OAAQF,EAAOG,MAAMC,MACnB,IAAK,QACHF,EAAWV,SAASa,eAAe,SACnC,MACF,IAAK,QACHH,EAAWV,SAASC,cAAc,SAClCS,EAASI,UAAW,EACpBJ,EAASK,UAAW,EACpB,MACF,QACE,OAEJP,EAAOQ,OAAON,GACdb,KAAKoB,gBAAgBZ,YAAYK,EAAA,CAErC,GAIK,SAASQ,EAAWC,EAAUf,EAAYa,GAC/CG,EAAAC,OAAOC,KAAKzB,KAAMsB,GAClBtB,KAAKO,WAAaA,EAClBP,KAAKoB,gBAAkBA,CACzB,CAEAC,EAAWK,UAAYC,OAAOC,OAAOL,EAAAC,OAAOE,WAC5CL,EAAWK,UAAUG,YAAcR,EAEnCM,OAAOG,OAAOT,EAAWK,UAAWjC,GC7CpC,MAAMsC,EAAkB5B,SAASa,eAAe,SAC1CgB,EAAkB7B,SAASa,eAAe,eAC1CiB,EAAkB9B,SAASa,eAAe,eAC1CkB,EAAkB/B,SAASa,eAAe,qBAE/C,WAEC,MACMmB,EAAK,IAAId,EADM,IAAIe,gBAAgBC,OAAOC,SAASC,QAClBC,IAAI,QAASP,EAAYC,SAC1DC,EAAGM,gBAETV,EAAK1B,YAAc8B,EAAGlC,OAAOF,GAE7BiC,EAAWvB,QAAU,KAEnB0B,EAAGO,OAAOC,aAAaC,SAAQjD,IAC7BwC,EAAGzC,mBAAmBC,EAAA,IAGxBwC,EAAGO,OAAOG,kBAAkBC,KAAKC,IAC/BZ,EAAGzC,mBAAmBqD,EAAEpD,YAAW,GACrC,CAIJ,EApBC","sources":["subscriber/js/subscriber.js","subscriber/js/index.js"],"sourcesContent":["import { nowInSec, SkyWayAuthToken, SkyWayContext, SkyWayRoom, SkyWayStreamFactory, uuidV4 } from '@skyway-sdk/room';\r\nimport { Member } from '../../js/member';\r\n\r\nconst subscriberPrototype = {\r\n\r\n  subscribeAndAttach: function (publication) {\r\n    console.log(publication.publisher.id);\r\n    console.log(this.myInfo);\r\n    if (publication.publisher.id === this.myInfo.id) return;\r\n    \r\n    const subscribeButton = document.createElement('button');\r\n    subscribeButton.textContent = `${publication.publisher.id}: ${publication.contentType}`;\r\n\r\n    this.buttonArea.appendChild(subscribeButton);\r\n\r\n    subscribeButton.onclick = async() => {\r\n      const { stream } = await this.myInfo.subscribe(publication.id);\r\n\r\n      let newMedia;\r\n      switch (stream.track.kind) {\r\n        case 'video':\r\n          newMedia = document.getElementById('video');\r\n          break;\r\n        case 'audio':\r\n          newMedia = document.createElement('audio');\r\n          newMedia.controls = true;\r\n          newMedia.autoplay = true;\r\n          break;  \r\n        default:\r\n          return;\r\n      }\r\n      stream.attach(newMedia);\r\n      this.remoteMediaArea.appendChild(newMedia);\r\n    }\r\n  },\r\n\r\n}\r\n\r\nexport function Subscriber(roomName, buttonArea, remoteMediaArea) {\r\n  Member.call(this, roomName);\r\n  this.buttonArea = buttonArea;\r\n  this.remoteMediaArea = remoteMediaArea;\r\n}\r\n\r\nSubscriber.prototype = Object.create(Member.prototype);\r\nSubscriber.prototype.constructor = Subscriber;\r\n\r\nObject.assign(Subscriber.prototype, subscriberPrototype);","import { Subscriber } from './subscriber';\r\n\r\nconst myId            = document.getElementById('my-id');\r\nconst listButton      = document.getElementById('list-button');\r\nconst buttonArea      = document.getElementById('button-area');\r\nconst remoteMediaArea = document.getElementById('remote-media-area');\r\n\r\n(async () => {\r\n\r\n  const searchParams = new URLSearchParams(window.location.search);\r\n  const me = new Subscriber(searchParams.get('room'), buttonArea, remoteMediaArea);\r\n  await me.initMyContext();\r\n\r\n  myId.textContent = me.myInfo.id;\r\n\r\n  listButton.onclick = () => {\r\n\r\n    me.myRoom.publications.forEach(publication => {\r\n      me.subscribeAndAttach(publication);\r\n    });\r\n\r\n    me.myRoom.onStreamPublished.add((e) => {\r\n      me.subscribeAndAttach(e.publication);\r\n    });\r\n\r\n  };\r\n\r\n})();"],"names":["parcelRequire","$87f6085c9daae876$var$subscriberPrototype","subscribeAndAttach","publication","console","log","publisher","id","this","myInfo","subscribeButton","document","createElement","textContent","contentType","buttonArea","appendChild","onclick","async","stream","subscribe","newMedia","track","kind","getElementById","controls","autoplay","attach","remoteMediaArea","$87f6085c9daae876$export$60959659b2c22881","roomName","$1C0k0","Member","call","prototype","Object","create","constructor","assign","$6fe57f0117413e88$var$myId","$6fe57f0117413e88$var$listButton","$6fe57f0117413e88$var$buttonArea","$6fe57f0117413e88$var$remoteMediaArea","me","URLSearchParams","window","location","search","get","initMyContext","myRoom","publications","forEach","onStreamPublished","add","e"],"version":3,"file":"index.4ba8263f.js.map"}