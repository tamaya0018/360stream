{"mappings":"oeAAA,IAAAA,EAAAC,EAAA,SAEA,MAAMC,EAAQ,IAAI,EAAAF,EAAAG,iBAAgB,CACjCC,KAAK,EAAAJ,EAAAK,UACLC,KAAK,EAAAN,EAAAO,YACLC,KAAK,EAAAR,EAAAO,YAAa,MAClBE,MAAO,CACNC,IAAK,CACJC,GAAI,uCACJC,MAAM,EACNC,QAAS,CAAC,QACVC,SAAU,CACT,CACCH,GAAI,IACJI,KAAM,IACNF,QAAS,CAAC,QACVG,QAAS,CACR,CACCL,GAAI,IACJI,KAAM,IACNF,QAAS,CAAC,SACVI,YAAa,CACZJ,QAAS,CAAC,UAEXK,aAAc,CACbL,QAAS,CAAC,YAIbM,QAAS,CACF,CACEN,QAAS,CAAC,SACVO,YAAa,CACX,CACEP,QAAS,CAAC,mBASzBQ,OAAO,gDAET,WACA,MAAMC,EAAaC,SAASC,eAAe,eACrCC,EAAkBF,SAASC,eAAe,qBAC1CE,EAAgBH,SAASC,eAAe,aACxCG,EAAOJ,SAASC,eAAe,SAClBD,SAASC,eAAe,QAEhCI,QAAUC,UACpB,GAA4B,KAAxBH,EAAcI,MAAc,OAEhC,MAAMC,QAAgB/B,EAAAgC,cAAcC,OAAO/B,GAErCgC,QAAalC,EAAAmC,WAAWC,aAAaL,EAAS,CACnDM,KAAM,MACNtB,KAAMW,EAAcI,QAGfQ,QAAWJ,EAAKK,OACtBZ,EAAKa,YAAcF,EAAG3B,GAEtB,MAAM8B,EAAsBxB,IAC3B,GAAIA,EAAYyB,UAAU/B,KAAO2B,EAAG3B,GAAI,OAExC,MAAMgC,EAAkBpB,SAASqB,cAAc,UAC/CD,EAAgBH,YAAc,GAAGvB,EAAYyB,UAAU/B,OAAOM,EAAY4B,cAE1EvB,EAAWwB,YAAYH,GAEvBA,EAAgBf,QAAUC,UACzB,MAAMkB,OAAEA,SAAiBT,EAAGU,UAAU/B,EAAYN,IAElD,IAAIsC,EAEE,UADEF,EAAOG,MAAMC,OAEnBF,EAAW1B,SAASC,eAAe,SAKrCuB,EAAOK,OAAOH,GACdxB,EAAgBqB,YAAYG,GAAA,CAC7B,EAGDf,EAAKmB,aAAaC,QAAQb,GAE1BP,EAAKqB,kBAAkBC,KAAKC,IAC3BhB,EAAmBgB,EAAExC,YAAW,GACjC,CAEF,EAlDC","sources":["src/subscriber/js/sub.js"],"sourcesContent":["import { nowInSec, SkyWayAuthToken, SkyWayContext, SkyWayRoom, SkyWayStreamFactory, uuidV4 } from '@skyway-sdk/room';\r\n\r\nconst token = new SkyWayAuthToken({\r\n\tjti: uuidV4(),\r\n\tiat: nowInSec(),\r\n\texp: nowInSec() + 60 * 60 * 24,\r\n\tscope: {\r\n\t\tapp: {\r\n\t\t\tid: '1194851a-7721-4348-951a-f502fd4dccb3',\r\n\t\t\tturn: true,\r\n\t\t\tactions: ['read'],\r\n\t\t\tchannels: [\r\n\t\t\t\t{\r\n\t\t\t\t\tid: '*',\r\n\t\t\t\t\tname: '*',\r\n\t\t\t\t\tactions: ['read'],\r\n\t\t\t\t\tmembers: [\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tid: '*',\r\n\t\t\t\t\t\t\tname: '*',\r\n\t\t\t\t\t\t\tactions: ['write'],\r\n\t\t\t\t\t\t\tpublication: {\r\n\t\t\t\t\t\t\t\tactions: ['write'],\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tsubscription: {\r\n\t\t\t\t\t\t\t\tactions: ['write'],\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t],\r\n\t\t\t\t\tsfuBots: [\r\n            {\r\n              actions: ['write'],\r\n              forwardings: [\r\n                {\r\n                  actions: ['write'],\r\n                },\r\n              ],\r\n            },\r\n          ],\r\n\t\t\t\t}\r\n\t\t\t]\r\n\t\t}\r\n\t}\r\n}).encode('zufyzTSf6JdsD1m4feyiG8id/aju8Hyh7ROgcyHeHKY=');\r\n\r\n(async () => {\r\n\tconst buttonArea = document.getElementById('button-area');\r\n\tconst remoteMediaArea = document.getElementById('remote-media-area');\r\n\tconst roomNameInput = document.getElementById('room-name');\r\n\tconst myId = document.getElementById('my-id');\r\n\tconst joinButton = document.getElementById('join');\r\n\r\n\tjoinButton.onclick = async () => {\r\n\t\tif (roomNameInput.value === '') return;\r\n\r\n\t\tconst context = await SkyWayContext.Create(token);\r\n\r\n\t\tconst room = await SkyWayRoom.FindOrCreate(context, {\r\n\t\t\ttype: 'p2p',\r\n\t\t\tname: roomNameInput.value,\r\n\t\t});\r\n\r\n\t\tconst me = await room.join();\r\n\t\tmyId.textContent = me.id;\r\n\r\n\t\tconst subscribeAndAttach = (publication) => {\r\n\t\t\tif (publication.publisher.id === me.id) return;\r\n\r\n\t\t\tconst subscribeButton = document.createElement('button');\r\n\t\t\tsubscribeButton.textContent = `${publication.publisher.id}: ${publication.contentType}`;\r\n\r\n\t\t\tbuttonArea.appendChild(subscribeButton);\r\n\r\n\t\t\tsubscribeButton.onclick = async () => {\r\n\t\t\t\tconst { stream } = await me.subscribe(publication.id);\r\n\r\n\t\t\t\tlet newMedia;\r\n\t\t\t\tswitch (stream.track.kind) {\r\n\t\t\t\t\tcase 'video':\r\n\t\t\t\t\t\tnewMedia = document.getElementById('video');\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tstream.attach(newMedia);\r\n\t\t\t\tremoteMediaArea.appendChild(newMedia);\r\n\t\t\t};\r\n\t\t};\r\n\r\n\t\troom.publications.forEach(subscribeAndAttach);\r\n\r\n\t\troom.onStreamPublished.add((e) => {\r\n\t\t\tsubscribeAndAttach(e.publication);\r\n\t\t});\r\n\t};\r\n})();"],"names":["$hlpVk","parcelRequire","$e4713fe90cbe4b8a$var$token","SkyWayAuthToken","jti","uuidV4","iat","nowInSec","exp","scope","app","id","turn","actions","channels","name","members","publication","subscription","sfuBots","forwardings","encode","buttonArea","document","getElementById","remoteMediaArea","roomNameInput","myId","onclick","async","value","context","SkyWayContext","Create","room","SkyWayRoom","FindOrCreate","type","me","join","textContent","subscribeAndAttach","publisher","subscribeButton","createElement","contentType","appendChild","stream","subscribe","newMedia","track","kind","attach","publications","forEach","onStreamPublished","add","e"],"version":3,"file":"index.6a7d937b.js.map"}